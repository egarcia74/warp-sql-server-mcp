services:
  sqlserver:
    image: "mcr.microsoft.com/azure-sql-edge:latest"
    container_name: warp-mcp-sqlserver
    hostname: warp-mcp-sqlserver
    environment:
      ACCEPT_EULA: Y
      SA_PASSWORD: WarpMCP123!
      MSSQL_PID: Developer
      MSSQL_AGENT_ENABLED: "false"
      MSSQL_COLLATION: SQL_Latin1_General_CP1_CI_AS
      MSSQL_TCP_PORT: 1433
      MSSQL_ENABLE_HADR: 0
    ports:
      - 1433:1433
    volumes:
      - ./init-db.sql:/tmp/init-db.sql:ro
      - sqlserver_data:/var/opt/mssql
    healthcheck:
      test:
        - CMD-SHELL
        - '/opt/mssql-tools18/bin/sqlcmd -S localhost -U sa -P "WarpMCP123!" -C -Q "SELECT 1" -t 10 || exit 1'
      interval: 12s
      timeout: 8s
      retries: 6
      start_period: 35s
    restart: unless-stopped
    networks:
      - warp-mcp-network
volumes:
  sqlserver_data:
    driver: local
networks:
  warp-mcp-network:
    driver: bridge
